
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Structured text generation with LLMs">
      
      
        <meta name="author" content="The Outlines developers">
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../prompts/">
      
      
      <link rel="icon" href="../../assets/images/logo.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Models - Outlines „Ä∞Ô∏è</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config",""),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Models - Outlines „Ä∞Ô∏è" >
      
        <meta  property="og:description"  content="Structured text generation with LLMs" >
      
        <meta  property="og:image"  content="./assets/images/social/api/models.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="None" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Models - Outlines „Ä∞Ô∏è" >
      
        <meta  name="twitter:description"  content="Structured text generation with LLMs" >
      
        <meta  name="twitter:image"  content="./assets/images/social/api/models.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#outlines.models.transformers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
              </button>
            
            
    For updates follow <strong>@dottxtai</strong> on
    <a href="https://twitter.com/dottxtai">
        <span class="twemoji twitter">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
        </span>
        <strong>Twitter</strong>
    </a>
    and
    <span class="twemoji stat">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M316.9 18c-5.3-11-16.5-18-28.8-18s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329l-24.6 145.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329l104.2-103.1c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7l-143.7-21.2L316.9 18z"/></svg>
    </span>
    the repo on
    <a href="https://github.com/outlines-dev/outlines">
        <span class="twemoji github">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
        </span>
        <strong>Github</strong>
    </a>

          </div>
          
            <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Outlines „Ä∞Ô∏è" class="md-header__button md-logo" aria-label="Outlines „Ä∞Ô∏è" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Outlines „Ä∞Ô∏è
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Models
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/outlines-dev/outlines" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    outlines-dev/outlines
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../welcome/" class="md-tabs__link">
          
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../cookbook/" class="md-tabs__link">
        
  
    
  
  Cookbook

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../reference/" class="md-tabs__link">
        
  
    
  
  Docs

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../" class="md-tabs__link">
        
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../community/" class="md-tabs__link">
        
  
    
  
  Community

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../blog/" class="md-tabs__link">
        
  
    
  
  Blog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Outlines „Ä∞Ô∏è" class="md-nav__button md-logo" aria-label="Outlines „Ä∞Ô∏è" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    Outlines „Ä∞Ô∏è
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/outlines-dev/outlines" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    outlines-dev/outlines
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../welcome/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to Outlines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../licence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Licence
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cookbook/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Cookbook
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Cookbook
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/extraction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Named Entity Extraction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/dating_profiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate synthetic data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/chain_of_density/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Summarize a document
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/models_playing_chess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Playing chess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Run on the cloud
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Run on the cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/deploy-using-bentoml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BentoML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/deploy-using-cerebrium/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cerebrium
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbook/deploy-using-modal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modal
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Docs
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Generation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Generation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/text/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Text
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/samplers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Samplers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Structured generation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Structured generation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/choices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/regex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Regex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/format/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type constraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON (function calling)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/json_mode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON mode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cfg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grammar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/custom_fsm_ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom FSM operations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utilities
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Utilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/serve/vllm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serve with vLLM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/prompting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prompt templating
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outlines functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_4_1" id="__nav_4_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Open source
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_1">
            <span class="md-nav__icon md-icon"></span>
            Open source
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/models/transformers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/models/llamacpp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama.cpp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/models/vllm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vLLM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/models/tgi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TGI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/models/exllamav2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ExllamaV2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/models/mlxlm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MLX
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/models/mamba/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mamba
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_4_2" id="__nav_4_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/models/openai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenAI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Models
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#outlines.models.transformers" class="md-nav__link">
    <span class="md-ellipsis">
      transformers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outlines.models.transformers.transformers" class="md-nav__link">
    <span class="md-ellipsis">
      transformers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transformers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outlines.models.transformers.transformers--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outlines.models.transformers.transformers--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outlines.models.openai" class="md-nav__link">
    <span class="md-ellipsis">
      openai
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI" class="md-nav__link">
    <span class="md-ellipsis">
      OpenAI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OpenAI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__call__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.__call__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.generate_choice" class="md-nav__link">
    <span class="md-ellipsis">
      generate_choice
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_choice">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.generate_choice--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.generate_json" class="md-nav__link">
    <span class="md-ellipsis">
      generate_json
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prompts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prompts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Json schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parsing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parsing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../regex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Regex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../samplers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Samplers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../community/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Community
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Community
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community/feedback/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feedback ü´∂
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://discord.com/invite/R9DSu34mGd" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chat with us ‚òï
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community/contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to contribute üèóÔ∏è
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community/examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Your projects üëè
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community/versioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Versioning Guide üìå
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#outlines.models.transformers" class="md-nav__link">
    <span class="md-ellipsis">
      transformers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outlines.models.transformers.transformers" class="md-nav__link">
    <span class="md-ellipsis">
      transformers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="transformers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outlines.models.transformers.transformers--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outlines.models.transformers.transformers--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outlines.models.openai" class="md-nav__link">
    <span class="md-ellipsis">
      openai
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI" class="md-nav__link">
    <span class="md-ellipsis">
      OpenAI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OpenAI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__call__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.__call__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.generate_choice" class="md-nav__link">
    <span class="md-ellipsis">
      generate_choice
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_choice">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.generate_choice--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outlines.models.openai.OpenAI.generate_json" class="md-nav__link">
    <span class="md-ellipsis">
      generate_json
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Models</h1>

<div class="doc doc-object doc-module">



<a id="outlines.models.transformers"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="outlines.models.transformers.transformers" class="doc doc-heading">
            <code class="highlight language-python"><span style="color: #d8dee9">transformers</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">model_name</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">device</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">model_kwargs</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #eceff4">{},</span> <span style="color: #d8dee9">tokenizer_kwargs</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #eceff4">{})</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Instantiate a model from the <code>transformers</code> library and its tokenizer.</p>
<h4 id="outlines.models.transformers.transformers--parameters">Parameters</h4>
<p>model_name
    The name of the model as listed on Hugging Face's model page.
device
    The device(s) on which the model should be loaded. This overrides
    the <code>device_map</code> entry in <code>model_kwargs</code> when provided.
model_kwargs
    A dictionary that contains the keyword arguments to pass to the
    <code>from_pretrained</code> method when loading the model.
tokenizer_kwargs
    A dictionary that contains the keyword arguments to pass to the
    <code>from_pretrained</code> method when loading the tokenizer.</p>
<h4 id="outlines.models.transformers.transformers--returns">Returns</h4>
<p>A <code>TransformersModel</code> model instance.</p>

            <details class="quote">
              <summary>Source code in <code>outlines/models/transformers.py</code></summary>
              <div class="language-python highlight" style="background: #2E3440"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-194">194</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-195">195</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-196">196</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-197">197</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-198">198</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-199">199</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-200">200</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-201">201</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-202">202</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-203">203</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-204">204</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-205">205</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-206">206</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-207">207</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-208">208</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-209">209</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-210">210</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-211">211</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-212">212</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-213">213</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-214">214</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-215">215</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-216">216</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-217">217</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-218">218</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-219">219</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-220">220</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-221">221</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-222">222</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-223">223</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-224">224</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-225">225</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-226">226</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-227">227</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-228">228</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-229">229</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-230">230</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-231">231</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-232">232</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-233">233</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-234">234</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-235">235</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-236">236</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a><span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">transformers</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span style="color: #d8dee9">model_name</span><span style="color: #eceff4">:</span> <span style="color: #81a1c1">str</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span style="color: #d8dee9">device</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span style="color: #d8dee9">model_kwargs</span><span style="color: #eceff4">:</span> <span style="color: #81a1c1">dict</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #eceff4">{},</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span style="color: #d8dee9">tokenizer_kwargs</span><span style="color: #eceff4">:</span> <span style="color: #81a1c1">dict</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #eceff4">{},</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a><span style="color: #eceff4">):</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a><span style="color: #d8dee9">    </span><span style="color: #616e87">&quot;&quot;&quot;Instantiate a model from the `transformers` library and its tokenizer.</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span style="color: #616e87">    Parameters</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span style="color: #616e87">    ----------</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span style="color: #616e87">    model_name</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a><span style="color: #616e87">        The name of the model as listed on Hugging Face&#39;s model page.</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span style="color: #616e87">    device</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a><span style="color: #616e87">        The device(s) on which the model should be loaded. This overrides</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a><span style="color: #616e87">        the `device_map` entry in `model_kwargs` when provided.</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a><span style="color: #616e87">    model_kwargs</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a><span style="color: #616e87">        A dictionary that contains the keyword arguments to pass to the</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a><span style="color: #616e87">        `from_pretrained` method when loading the model.</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a><span style="color: #616e87">    tokenizer_kwargs</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span style="color: #616e87">        A dictionary that contains the keyword arguments to pass to the</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a><span style="color: #616e87">        `from_pretrained` method when loading the tokenizer.</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a><span style="color: #616e87">    Returns</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a><span style="color: #616e87">    -------</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a><span style="color: #616e87">    A `TransformersModel` model instance.</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a><span style="color: #616e87">    &quot;&quot;&quot;</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span style="color: #81a1c1; font-weight: bold">try</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span style="color: #81a1c1; font-weight: bold">from</span> <span style="color: #8fbcbb">transformers</span> <span style="color: #81a1c1; font-weight: bold">import</span> <span style="color: #d8dee9">AutoModelForCausalLM</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">AutoTokenizer</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span style="color: #81a1c1; font-weight: bold">except</span> <span style="color: #bf616a">ImportError</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span style="color: #81a1c1; font-weight: bold">raise</span> <span style="color: #bf616a">ImportError</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span style="color: #a3be8c">&quot;The `transformers` library needs to be installed in order to use `transformers` models.&quot;</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span style="color: #eceff4">)</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">device</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">not</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span style="color: #d8dee9">model_kwargs</span><span style="color: #eceff4">[</span><span style="color: #a3be8c">&quot;device_map&quot;</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">device</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span style="color: #d8dee9">model</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">AutoModelForCausalLM</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">from_pretrained</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">model_name</span><span style="color: #eceff4">,</span> <span style="color: #81a1c1; font-weight: bold">**</span><span style="color: #d8dee9">model_kwargs</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span style="color: #d8dee9">tokenizer_kwargs</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">setdefault</span><span style="color: #eceff4">(</span><span style="color: #a3be8c">&quot;padding_side&quot;</span><span style="color: #eceff4">,</span> <span style="color: #a3be8c">&quot;left&quot;</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span style="color: #d8dee9">tokenizer</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">AutoTokenizer</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">from_pretrained</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">model_name</span><span style="color: #eceff4">,</span> <span style="color: #81a1c1; font-weight: bold">**</span><span style="color: #d8dee9">tokenizer_kwargs</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span style="color: #81a1c1; font-weight: bold">return</span> <span style="color: #d8dee9">Transformers</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">model</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">tokenizer</span><span style="color: #eceff4">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="outlines.models.openai"></a>
    <div class="doc doc-contents first">

      <p>Integration with OpenAI's API.</p>



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="outlines.models.openai.OpenAI" class="doc doc-heading">
            <code>OpenAI</code>


</h2>


    <div class="doc doc-contents ">


      <p>An object that represents the OpenAI API.</p>

              <details class="quote">
                <summary>Source code in <code>outlines/models/openai.py</code></summary>
                <div class="language-python highlight" style="background: #2E3440"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-69"> 69</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-70"> 70</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-71"> 71</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-72"> 72</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-73"> 73</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-74"> 74</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-75"> 75</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-76"> 76</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-77"> 77</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-78"> 78</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-79"> 79</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-80"> 80</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-81"> 81</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-82"> 82</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-83"> 83</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-84"> 84</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-85"> 85</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-86"> 86</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-87"> 87</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-88"> 88</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-89"> 89</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-90"> 90</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-91"> 91</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-92"> 92</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-93"> 93</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-94"> 94</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-95"> 95</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-96"> 96</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-97"> 97</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-98"> 98</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-99"> 99</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-100">100</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-101">101</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-102">102</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-103">103</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-104">104</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-105">105</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-106">106</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-107">107</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-108">108</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-109">109</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-110">110</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-111">111</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-112">112</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-113">113</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-114">114</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-115">115</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-116">116</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-117">117</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-118">118</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-119">119</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-120">120</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-121">121</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-122">122</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-123">123</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-124">124</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-125">125</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-126">126</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-127">127</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-128">128</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-129">129</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-130">130</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-131">131</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-132">132</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-133">133</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-134">134</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-135">135</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-136">136</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-137">137</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-138">138</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-139">139</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-140">140</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-141">141</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-142">142</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-143">143</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-144">144</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-145">145</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-146">146</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-147">147</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-148">148</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-149">149</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-150">150</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-151">151</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-152">152</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-153">153</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-154">154</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-155">155</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-156">156</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-157">157</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-158">158</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-159">159</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-160">160</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-161">161</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-162">162</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-163">163</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-164">164</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-165">165</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-166">166</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-167">167</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-168">168</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-169">169</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-170">170</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-171">171</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-172">172</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-173">173</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-174">174</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-175">175</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-176">176</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-177">177</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-178">178</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-179">179</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-180">180</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-181">181</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-182">182</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-183">183</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-184">184</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-185">185</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-186">186</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-187">187</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-188">188</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-189">189</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-190">190</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-191">191</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-192">192</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-193">193</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-194">194</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-195">195</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-196">196</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-197">197</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-198">198</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-199">199</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-200">200</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-201">201</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-202">202</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-203">203</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-204">204</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-205">205</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-206">206</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-207">207</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-208">208</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-209">209</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-210">210</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-211">211</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-212">212</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-213">213</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-214">214</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-215">215</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-216">216</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-217">217</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-218">218</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-219">219</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-220">220</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-221">221</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-222">222</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-223">223</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-224">224</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-225">225</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-226">226</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-227">227</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-228">228</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-229">229</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-230">230</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-231">231</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-232">232</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-233">233</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-234">234</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-235">235</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-236">236</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-237">237</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-238">238</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-239">239</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-240">240</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-241">241</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-242">242</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-243">243</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-244">244</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-245">245</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-246">246</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-247">247</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-248">248</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-249">249</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-250">250</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-251">251</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-252">252</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-253">253</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-254">254</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-255">255</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-256">256</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-257">257</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-258">258</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-259">259</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-260">260</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span style="color: #81a1c1; font-weight: bold">class</span> <span style="color: #8fbcbb">OpenAI</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span style="color: #d8dee9">    </span><span style="color: #616e87">&quot;&quot;&quot;An object that represents the OpenAI API.&quot;&quot;&quot;</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71"></a>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">__init__</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span style="color: #81a1c1">self</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span style="color: #d8dee9">client</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span style="color: #d8dee9">config</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span style="color: #d8dee9">tokenizer</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span style="color: #d8dee9">system_prompt</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span style="color: #eceff4">):</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span style="color: #d8dee9">        </span><span style="color: #616e87">&quot;&quot;&quot;Create an `OpenAI` instance.</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span style="color: #616e87">        This class supports the standard OpenAI API, the Azure OpeanAI API as</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span style="color: #616e87">        well as compatible APIs that rely on the OpenAI client.</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span style="color: #616e87">        Parameters</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span style="color: #616e87">        ----------</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a><span style="color: #616e87">        client</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a><span style="color: #616e87">            An instance of the API&#39;s async client.</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span style="color: #616e87">        config</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a><span style="color: #616e87">            An instance of `OpenAIConfig`. Can be useful to specify some</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span style="color: #616e87">            parameters that cannot be set by calling this class&#39; methods.</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a><span style="color: #616e87">        tokenizer</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span style="color: #616e87">            The tokenizer associated with the model the client connects to.</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a><span style="color: #616e87">        &quot;&quot;&quot;</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">client</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">client</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">tokenizer</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">config</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span style="color: #616e87; font-style: italic"># We count the total number of prompt and generated tokens as returned</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span style="color: #616e87; font-style: italic"># by the OpenAI API, summed over all the requests performed with this</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span style="color: #616e87; font-style: italic"># model instance.</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">prompt_tokens</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #b48ead">0</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">completion_tokens</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #b48ead">0</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">__call__</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span style="color: #81a1c1">self</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span style="color: #d8dee9">prompt</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Union</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">]],</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span style="color: #d8dee9">max_tokens</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">int</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span style="color: #d8dee9">stop_at</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #d8dee9">Union</span><span style="color: #eceff4">[</span><span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">],</span> <span style="color: #81a1c1">str</span><span style="color: #eceff4">]]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span style="color: #81a1c1; font-weight: bold">*</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span style="color: #d8dee9">system_prompt</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span style="color: #d8dee9">temperature</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">float</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span style="color: #d8dee9">samples</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">int</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">-&gt;</span> <span style="color: #d8dee9">np</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">ndarray</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span style="color: #d8dee9">        </span><span style="color: #616e87">&quot;&quot;&quot;Call the OpenAI API to generate text.</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span style="color: #616e87">        Parameters</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span style="color: #616e87">        ----------</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span style="color: #616e87">        prompt</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span style="color: #616e87">            A string or list of strings that will be used to prompt the model</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span style="color: #616e87">        max_tokens</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span style="color: #616e87">            The maximum number of tokens to generate</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span style="color: #616e87">        stop_at</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span style="color: #616e87">            A string or array of strings which, such that the generation stops</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a><span style="color: #616e87">            when they are generated.</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span style="color: #616e87">        system_prompt</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span style="color: #616e87">            The content of the system message that precedes the user&#39;s prompt.</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span style="color: #616e87">        temperature</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span style="color: #616e87">            The value of the temperature used to sample tokens</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span style="color: #616e87">        samples</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span style="color: #616e87">            The number of completions to generate for each prompt</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span style="color: #616e87">        stop_at</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span style="color: #616e87">            Up to 4 words where the API will stop the completion.</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span style="color: #616e87">        &quot;&quot;&quot;</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">max_tokens</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span style="color: #d8dee9">max_tokens</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">max_tokens</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">stop_at</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span style="color: #d8dee9">stop_at</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">stop</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">temperature</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span style="color: #d8dee9">temperature</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">temperature</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">samples</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span style="color: #d8dee9">samples</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">n</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span style="color: #d8dee9">config</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">replace</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">max_tokens</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">max_tokens</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">temperature</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">temperature</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">n</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">samples</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">stop</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">stop_at</span><span style="color: #eceff4">)</span>  <span style="color: #616e87; font-style: italic"># type: ignore</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span style="color: #d8dee9">response</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">prompt_tokens</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">completion_tokens</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">generate_chat</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span style="color: #d8dee9">prompt</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">system_prompt</span><span style="color: #eceff4">,</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">client</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">config</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span style="color: #eceff4">)</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">prompt_tokens</span> <span style="color: #81a1c1; font-weight: bold">+=</span> <span style="color: #d8dee9">prompt_tokens</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">completion_tokens</span> <span style="color: #81a1c1; font-weight: bold">+=</span> <span style="color: #d8dee9">completion_tokens</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span style="color: #81a1c1; font-weight: bold">return</span> <span style="color: #d8dee9">response</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">stream</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #eceff4">,</span> <span style="color: #81a1c1; font-weight: bold">*</span><span style="color: #d8dee9">args</span><span style="color: #eceff4">,</span> <span style="color: #81a1c1; font-weight: bold">**</span><span style="color: #d8dee9">kwargs</span><span style="color: #eceff4">):</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span style="color: #81a1c1; font-weight: bold">raise</span> <span style="color: #bf616a">NotImplementedError</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span style="color: #a3be8c">&quot;Streaming is currently not supported for the OpenAI API&quot;</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span style="color: #eceff4">)</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">generate_choice</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span style="color: #81a1c1">self</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span style="color: #d8dee9">prompt</span><span style="color: #eceff4">:</span> <span style="color: #81a1c1">str</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span style="color: #d8dee9">choices</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">],</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span style="color: #d8dee9">max_tokens</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">int</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span style="color: #d8dee9">system_prompt</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">-&gt;</span> <span style="color: #81a1c1">str</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span style="color: #d8dee9">        </span><span style="color: #616e87">&quot;&quot;&quot;Call the OpenAI API to generate one of several choices.</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a><span style="color: #616e87">        Parameters</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span style="color: #616e87">        ----------</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span style="color: #616e87">        prompt</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span style="color: #616e87">            A string or list of strings that will be used to prompt the model</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span style="color: #616e87">        choices</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span style="color: #616e87">            The list of strings between which we ask the model to choose</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span style="color: #616e87">        max_tokens</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span style="color: #616e87">            The maximum number of tokens to generate</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span style="color: #616e87">        system_prompt</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span style="color: #616e87">            The content of the system message that precedes the user&#39;s prompt.</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a><span style="color: #616e87">        &quot;&quot;&quot;</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span style="color: #81a1c1; font-weight: bold">raise</span> <span style="color: #bf616a">ValueError</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>                <span style="color: #a3be8c">&quot;You must initialize the `OpenAI` class with a tokenizer to use `outlines.generate.choice`&quot;</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span style="color: #eceff4">)</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span style="color: #d8dee9">config</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">replace</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">max_tokens</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">max_tokens</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span style="color: #d8dee9">greedy</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">False</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span style="color: #d8dee9">decoded</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #eceff4">[]</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">int</span><span style="color: #eceff4">]]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #eceff4">[</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">encode</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">word</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">for</span> <span style="color: #d8dee9">word</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">choices</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span style="color: #eceff4">]</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span style="color: #81a1c1; font-weight: bold">while</span> <span style="color: #81a1c1">len</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">&gt;</span> <span style="color: #b48ead">0</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span style="color: #d8dee9">max_tokens_left</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">max</span><span style="color: #eceff4">([</span><span style="color: #81a1c1">len</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">tokens</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">for</span> <span style="color: #d8dee9">tokens</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">])</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span style="color: #d8dee9">transposed_choices_left</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #d8dee9">Set</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #eceff4">[</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>                <span style="color: #eceff4">{</span><span style="color: #d8dee9">item</span> <span style="color: #81a1c1; font-weight: bold">for</span> <span style="color: #d8dee9">item</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">subset</span> <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">item</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">not</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">}</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>                <span style="color: #81a1c1; font-weight: bold">for</span> <span style="color: #d8dee9">subset</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">zip_longest</span><span style="color: #eceff4">(</span><span style="color: #81a1c1; font-weight: bold">*</span><span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span style="color: #eceff4">]</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #81a1c1; font-weight: bold">not</span> <span style="color: #d8dee9">greedy</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>                <span style="color: #d8dee9">mask</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">build_optimistic_mask</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">transposed_choices_left</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span style="color: #81a1c1; font-weight: bold">else</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span style="color: #d8dee9">mask</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #eceff4">{}</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>                <span style="color: #81a1c1; font-weight: bold">for</span> <span style="color: #d8dee9">token</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">transposed_choices_left</span><span style="color: #eceff4">[</span><span style="color: #b48ead">0</span><span style="color: #eceff4">]:</span>  <span style="color: #616e87; font-style: italic"># build greedy mask</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>                    <span style="color: #d8dee9">mask</span><span style="color: #eceff4">[</span><span style="color: #d8dee9">token</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #b48ead">100</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #81a1c1">len</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">mask</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">==</span> <span style="color: #b48ead">0</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>                <span style="color: #81a1c1; font-weight: bold">break</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span style="color: #d8dee9">config</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">replace</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">config</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">logit_bias</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">mask</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">max_tokens</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">max_tokens_left</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span style="color: #d8dee9">response</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">prompt_tokens</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">completion_tokens</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">generate_chat</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a>                <span style="color: #d8dee9">prompt</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">system_prompt</span><span style="color: #eceff4">,</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">client</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">config</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span style="color: #eceff4">)</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">prompt_tokens</span> <span style="color: #81a1c1; font-weight: bold">+=</span> <span style="color: #d8dee9">prompt_tokens</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">completion_tokens</span> <span style="color: #81a1c1; font-weight: bold">+=</span> <span style="color: #d8dee9">completion_tokens</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span style="color: #d8dee9">encoded_response</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">encode</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">response</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">encoded_response</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>                <span style="color: #d8dee9">decoded</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">append</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">response</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span style="color: #81a1c1; font-weight: bold">break</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span style="color: #81a1c1; font-weight: bold">else</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a>                <span style="color: #eceff4">(</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>                    <span style="color: #d8dee9">encoded_response</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a>                    <span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a>                <span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">find_response_choices_intersection</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a>                    <span style="color: #d8dee9">encoded_response</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">encoded_choices_left</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a>                <span style="color: #eceff4">)</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a>                <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #81a1c1">len</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">encoded_response</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">==</span> <span style="color: #b48ead">0</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a>                    <span style="color: #d8dee9">greedy</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">True</span>  <span style="color: #616e87; font-style: italic"># next iteration will be &quot;greedy&quot;</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a>                    <span style="color: #81a1c1; font-weight: bold">continue</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>                <span style="color: #81a1c1; font-weight: bold">else</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a>                    <span style="color: #d8dee9">decoded</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">append</span><span style="color: #eceff4">(</span><span style="color: #a3be8c">&quot;&quot;</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">join</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">decode</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">encoded_response</span><span style="color: #eceff4">)))</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a>                    <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #81a1c1">len</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">==</span> <span style="color: #b48ead">1</span><span style="color: #eceff4">:</span>  <span style="color: #616e87; font-style: italic"># only one choice left</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a>                        <span style="color: #d8dee9">choice_left</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">decode</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">[</span><span style="color: #b48ead">0</span><span style="color: #eceff4">])</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>                        <span style="color: #d8dee9">decoded</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">append</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">choice_left</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a>                        <span style="color: #81a1c1; font-weight: bold">break</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a>                    <span style="color: #d8dee9">greedy</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">False</span>  <span style="color: #616e87; font-style: italic"># after each success, stay with (or switch to) &quot;optimistic&quot; approach</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>                <span style="color: #d8dee9">prompt</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">prompt</span> <span style="color: #81a1c1; font-weight: bold">+</span> <span style="color: #a3be8c">&quot;&quot;</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">join</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">decoded</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span style="color: #d8dee9">choice</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #a3be8c">&quot;&quot;</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">join</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">decoded</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span style="color: #81a1c1; font-weight: bold">return</span> <span style="color: #d8dee9">choice</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">generate_json</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #eceff4">):</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span style="color: #d8dee9">        </span><span style="color: #616e87">&quot;&quot;&quot;Call the OpenAI API to generate a JSON object.&quot;&quot;&quot;</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span style="color: #81a1c1; font-weight: bold">raise</span> <span style="color: #bf616a">NotImplementedError</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">__str__</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #eceff4">):</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span style="color: #81a1c1; font-weight: bold">return</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">__class__</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">__name__</span> <span style="color: #81a1c1; font-weight: bold">+</span> <span style="color: #a3be8c">&quot; API&quot;</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">__repr__</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #eceff4">):</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span style="color: #81a1c1; font-weight: bold">return</span> <span style="color: #81a1c1">str</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #eceff4">)</span>
</span></code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="outlines.models.openai.OpenAI.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span style="color: #88c0d0">__call__</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">prompt</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">max_tokens</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">stop_at</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">,</span> <span style="color: #81a1c1; font-weight: bold">*</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">system_prompt</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">temperature</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">samples</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Call the OpenAI API to generate text.</p>
<h5 id="outlines.models.openai.OpenAI.__call__--parameters">Parameters</h5>
<p>prompt
    A string or list of strings that will be used to prompt the model
max_tokens
    The maximum number of tokens to generate
stop_at
    A string or array of strings which, such that the generation stops
    when they are generated.
system_prompt
    The content of the system message that precedes the user's prompt.
temperature
    The value of the temperature used to sample tokens
samples
    The number of completions to generate for each prompt
stop_at
    Up to 4 words where the API will stop the completion.</p>

            <details class="quote">
              <summary>Source code in <code>outlines/models/openai.py</code></summary>
              <div class="language-python highlight" style="background: #2E3440"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-106">106</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-107">107</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-108">108</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-109">109</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-110">110</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-111">111</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-112">112</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-113">113</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-114">114</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-115">115</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-116">116</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-117">117</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-118">118</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-119">119</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-120">120</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-121">121</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-122">122</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-123">123</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-124">124</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-125">125</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-126">126</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-127">127</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-128">128</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-129">129</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-130">130</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-131">131</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-132">132</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-133">133</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-134">134</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-135">135</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-136">136</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-137">137</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-138">138</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-139">139</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-140">140</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-141">141</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-142">142</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-143">143</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-144">144</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-145">145</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-146">146</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-147">147</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-148">148</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-149">149</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-150">150</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-151">151</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-152">152</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-153">153</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-154">154</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a><span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">__call__</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span style="color: #81a1c1">self</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span style="color: #d8dee9">prompt</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Union</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">]],</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span style="color: #d8dee9">max_tokens</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">int</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span style="color: #d8dee9">stop_at</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #d8dee9">Union</span><span style="color: #eceff4">[</span><span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">],</span> <span style="color: #81a1c1">str</span><span style="color: #eceff4">]]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span style="color: #81a1c1; font-weight: bold">*</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span style="color: #d8dee9">system_prompt</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span style="color: #d8dee9">temperature</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">float</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span style="color: #d8dee9">samples</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">int</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">-&gt;</span> <span style="color: #d8dee9">np</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">ndarray</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span style="color: #d8dee9">    </span><span style="color: #616e87">&quot;&quot;&quot;Call the OpenAI API to generate text.</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span style="color: #616e87">    Parameters</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span style="color: #616e87">    ----------</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span style="color: #616e87">    prompt</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span style="color: #616e87">        A string or list of strings that will be used to prompt the model</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span style="color: #616e87">    max_tokens</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span style="color: #616e87">        The maximum number of tokens to generate</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span style="color: #616e87">    stop_at</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span style="color: #616e87">        A string or array of strings which, such that the generation stops</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a><span style="color: #616e87">        when they are generated.</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span style="color: #616e87">    system_prompt</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span style="color: #616e87">        The content of the system message that precedes the user&#39;s prompt.</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span style="color: #616e87">    temperature</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span style="color: #616e87">        The value of the temperature used to sample tokens</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span style="color: #616e87">    samples</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span style="color: #616e87">        The number of completions to generate for each prompt</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span style="color: #616e87">    stop_at</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span style="color: #616e87">        Up to 4 words where the API will stop the completion.</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span style="color: #616e87">    &quot;&quot;&quot;</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">max_tokens</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span style="color: #d8dee9">max_tokens</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">max_tokens</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">stop_at</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span style="color: #d8dee9">stop_at</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">stop</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">temperature</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span style="color: #d8dee9">temperature</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">temperature</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">samples</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span style="color: #d8dee9">samples</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">n</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span style="color: #d8dee9">config</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">replace</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">max_tokens</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">max_tokens</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">temperature</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">temperature</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">n</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">samples</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">stop</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">stop_at</span><span style="color: #eceff4">)</span>  <span style="color: #616e87; font-style: italic"># type: ignore</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span style="color: #d8dee9">response</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">prompt_tokens</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">completion_tokens</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">generate_chat</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span style="color: #d8dee9">prompt</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">system_prompt</span><span style="color: #eceff4">,</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">client</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">config</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span style="color: #eceff4">)</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">prompt_tokens</span> <span style="color: #81a1c1; font-weight: bold">+=</span> <span style="color: #d8dee9">prompt_tokens</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">completion_tokens</span> <span style="color: #81a1c1; font-weight: bold">+=</span> <span style="color: #d8dee9">completion_tokens</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span style="color: #81a1c1; font-weight: bold">return</span> <span style="color: #d8dee9">response</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="outlines.models.openai.OpenAI.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span style="color: #88c0d0">__init__</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">client</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">config</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">tokenizer</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">system_prompt</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Create an <code>OpenAI</code> instance.</p>
<p>This class supports the standard OpenAI API, the Azure OpeanAI API as
well as compatible APIs that rely on the OpenAI client.</p>
<h5 id="outlines.models.openai.OpenAI.__init__--parameters">Parameters</h5>
<p>client
    An instance of the API's async client.
config
    An instance of <code>OpenAIConfig</code>. Can be useful to specify some
    parameters that cannot be set by calling this class' methods.
tokenizer
    The tokenizer associated with the model the client connects to.</p>

            <details class="quote">
              <summary>Source code in <code>outlines/models/openai.py</code></summary>
              <div class="language-python highlight" style="background: #2E3440"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-72"> 72</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-73"> 73</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-74"> 74</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-75"> 75</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-76"> 76</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-77"> 77</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-78"> 78</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-79"> 79</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-80"> 80</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-81"> 81</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-82"> 82</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-83"> 83</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-84"> 84</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-85"> 85</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-86"> 86</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-87"> 87</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-88"> 88</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-89"> 89</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-90"> 90</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-91"> 91</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-92"> 92</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-93"> 93</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-94"> 94</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-95"> 95</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-96"> 96</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-97"> 97</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-98"> 98</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-99"> 99</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-100">100</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-101">101</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-102">102</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-103">103</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-104">104</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">__init__</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span style="color: #81a1c1">self</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span style="color: #d8dee9">client</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span style="color: #d8dee9">config</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span style="color: #d8dee9">tokenizer</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span style="color: #d8dee9">system_prompt</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span style="color: #eceff4">):</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span style="color: #d8dee9">    </span><span style="color: #616e87">&quot;&quot;&quot;Create an `OpenAI` instance.</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span style="color: #616e87">    This class supports the standard OpenAI API, the Azure OpeanAI API as</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span style="color: #616e87">    well as compatible APIs that rely on the OpenAI client.</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span style="color: #616e87">    Parameters</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span style="color: #616e87">    ----------</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86"></a><span style="color: #616e87">    client</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87"></a><span style="color: #616e87">        An instance of the API&#39;s async client.</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span style="color: #616e87">    config</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89"></a><span style="color: #616e87">        An instance of `OpenAIConfig`. Can be useful to specify some</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span style="color: #616e87">        parameters that cannot be set by calling this class&#39; methods.</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a><span style="color: #616e87">    tokenizer</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span style="color: #616e87">        The tokenizer associated with the model the client connects to.</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a><span style="color: #616e87">    &quot;&quot;&quot;</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">client</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">client</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">tokenizer</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">config</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span style="color: #616e87; font-style: italic"># We count the total number of prompt and generated tokens as returned</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span style="color: #616e87; font-style: italic"># by the OpenAI API, summed over all the requests performed with this</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span style="color: #616e87; font-style: italic"># model instance.</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">prompt_tokens</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #b48ead">0</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">completion_tokens</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #b48ead">0</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="outlines.models.openai.OpenAI.generate_choice" class="doc doc-heading">
            <code class="highlight language-python"><span style="color: #d8dee9">generate_choice</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">prompt</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">choices</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">max_tokens</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">system_prompt</span><span style="color: #81a1c1; font-weight: bold">=None</span><span style="color: #eceff4">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Call the OpenAI API to generate one of several choices.</p>
<h5 id="outlines.models.openai.OpenAI.generate_choice--parameters">Parameters</h5>
<p>prompt
    A string or list of strings that will be used to prompt the model
choices
    The list of strings between which we ask the model to choose
max_tokens
    The maximum number of tokens to generate
system_prompt
    The content of the system message that precedes the user's prompt.</p>

            <details class="quote">
              <summary>Source code in <code>outlines/models/openai.py</code></summary>
              <div class="language-python highlight" style="background: #2E3440"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-161">161</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-162">162</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-163">163</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-164">164</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-165">165</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-166">166</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-167">167</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-168">168</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-169">169</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-170">170</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-171">171</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-172">172</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-173">173</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-174">174</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-175">175</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-176">176</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-177">177</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-178">178</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-179">179</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-180">180</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-181">181</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-182">182</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-183">183</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-184">184</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-185">185</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-186">186</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-187">187</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-188">188</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-189">189</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-190">190</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-191">191</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-192">192</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-193">193</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-194">194</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-195">195</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-196">196</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-197">197</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-198">198</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-199">199</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-200">200</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-201">201</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-202">202</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-203">203</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-204">204</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-205">205</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-206">206</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-207">207</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-208">208</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-209">209</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-210">210</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-211">211</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-212">212</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-213">213</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-214">214</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-215">215</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-216">216</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-217">217</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-218">218</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-219">219</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-220">220</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-221">221</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-222">222</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-223">223</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-224">224</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-225">225</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-226">226</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-227">227</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-228">228</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-229">229</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-230">230</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-231">231</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-232">232</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-233">233</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-234">234</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-235">235</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-236">236</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-237">237</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-238">238</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-239">239</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-240">240</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-241">241</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-242">242</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-243">243</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-244">244</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-245">245</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-246">246</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-247">247</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-248">248</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-249">249</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-250">250</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a><span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">generate_choice</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span style="color: #81a1c1">self</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span style="color: #d8dee9">prompt</span><span style="color: #eceff4">:</span> <span style="color: #81a1c1">str</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span style="color: #d8dee9">choices</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">],</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span style="color: #d8dee9">max_tokens</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">int</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span style="color: #d8dee9">system_prompt</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">Optional</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">-&gt;</span> <span style="color: #81a1c1">str</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span style="color: #d8dee9">    </span><span style="color: #616e87">&quot;&quot;&quot;Call the OpenAI API to generate one of several choices.</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a><span style="color: #616e87">    Parameters</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span style="color: #616e87">    ----------</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span style="color: #616e87">    prompt</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span style="color: #616e87">        A string or list of strings that will be used to prompt the model</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span style="color: #616e87">    choices</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span style="color: #616e87">        The list of strings between which we ask the model to choose</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span style="color: #616e87">    max_tokens</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span style="color: #616e87">        The maximum number of tokens to generate</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span style="color: #616e87">    system_prompt</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span style="color: #616e87">        The content of the system message that precedes the user&#39;s prompt.</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a><span style="color: #616e87">    &quot;&quot;&quot;</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span style="color: #81a1c1; font-weight: bold">raise</span> <span style="color: #bf616a">ValueError</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span style="color: #a3be8c">&quot;You must initialize the `OpenAI` class with a tokenizer to use `outlines.generate.choice`&quot;</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span style="color: #eceff4">)</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span style="color: #d8dee9">config</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">replace</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">config</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">max_tokens</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">max_tokens</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span style="color: #d8dee9">greedy</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">False</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span style="color: #d8dee9">decoded</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">str</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #eceff4">[]</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #81a1c1">int</span><span style="color: #eceff4">]]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #eceff4">[</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">encode</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">word</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">for</span> <span style="color: #d8dee9">word</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">choices</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span style="color: #eceff4">]</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span style="color: #81a1c1; font-weight: bold">while</span> <span style="color: #81a1c1">len</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">&gt;</span> <span style="color: #b48ead">0</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span style="color: #d8dee9">max_tokens_left</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">max</span><span style="color: #eceff4">([</span><span style="color: #81a1c1">len</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">tokens</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">for</span> <span style="color: #d8dee9">tokens</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">])</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span style="color: #d8dee9">transposed_choices_left</span><span style="color: #eceff4">:</span> <span style="color: #d8dee9">List</span><span style="color: #eceff4">[</span><span style="color: #d8dee9">Set</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #eceff4">[</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span style="color: #eceff4">{</span><span style="color: #d8dee9">item</span> <span style="color: #81a1c1; font-weight: bold">for</span> <span style="color: #d8dee9">item</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">subset</span> <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">item</span> <span style="color: #81a1c1; font-weight: bold">is</span> <span style="color: #81a1c1; font-weight: bold">not</span> <span style="color: #81a1c1; font-weight: bold">None</span><span style="color: #eceff4">}</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span style="color: #81a1c1; font-weight: bold">for</span> <span style="color: #d8dee9">subset</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">zip_longest</span><span style="color: #eceff4">(</span><span style="color: #81a1c1; font-weight: bold">*</span><span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span style="color: #eceff4">]</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #81a1c1; font-weight: bold">not</span> <span style="color: #d8dee9">greedy</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span style="color: #d8dee9">mask</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">build_optimistic_mask</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">transposed_choices_left</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span style="color: #81a1c1; font-weight: bold">else</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span style="color: #d8dee9">mask</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #eceff4">{}</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span style="color: #81a1c1; font-weight: bold">for</span> <span style="color: #d8dee9">token</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">transposed_choices_left</span><span style="color: #eceff4">[</span><span style="color: #b48ead">0</span><span style="color: #eceff4">]:</span>  <span style="color: #616e87; font-style: italic"># build greedy mask</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span style="color: #d8dee9">mask</span><span style="color: #eceff4">[</span><span style="color: #d8dee9">token</span><span style="color: #eceff4">]</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #b48ead">100</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #81a1c1">len</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">mask</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">==</span> <span style="color: #b48ead">0</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span style="color: #81a1c1; font-weight: bold">break</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211"></a>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span style="color: #d8dee9">config</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">replace</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">config</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">logit_bias</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">mask</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">max_tokens</span><span style="color: #81a1c1; font-weight: bold">=</span><span style="color: #d8dee9">max_tokens_left</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213"></a>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span style="color: #d8dee9">response</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">prompt_tokens</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">completion_tokens</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">generate_chat</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span style="color: #d8dee9">prompt</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">system_prompt</span><span style="color: #eceff4">,</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">client</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">config</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span style="color: #eceff4">)</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">prompt_tokens</span> <span style="color: #81a1c1; font-weight: bold">+=</span> <span style="color: #d8dee9">prompt_tokens</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">completion_tokens</span> <span style="color: #81a1c1; font-weight: bold">+=</span> <span style="color: #d8dee9">completion_tokens</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219"></a>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span style="color: #d8dee9">encoded_response</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">encode</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">response</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221"></a>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #d8dee9">encoded_response</span> <span style="color: #81a1c1; font-weight: bold">in</span> <span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span style="color: #d8dee9">decoded</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">append</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">response</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span style="color: #81a1c1; font-weight: bold">break</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span style="color: #81a1c1; font-weight: bold">else</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span style="color: #eceff4">(</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227"></a>                <span style="color: #d8dee9">encoded_response</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228"></a>                <span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">,</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">find_response_choices_intersection</span><span style="color: #eceff4">(</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230"></a>                <span style="color: #d8dee9">encoded_response</span><span style="color: #eceff4">,</span> <span style="color: #d8dee9">encoded_choices_left</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span style="color: #eceff4">)</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232"></a>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #81a1c1">len</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">encoded_response</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">==</span> <span style="color: #b48ead">0</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234"></a>                <span style="color: #d8dee9">greedy</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">True</span>  <span style="color: #616e87; font-style: italic"># next iteration will be &quot;greedy&quot;</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235"></a>                <span style="color: #81a1c1; font-weight: bold">continue</span>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span style="color: #81a1c1; font-weight: bold">else</span><span style="color: #eceff4">:</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237"></a>                <span style="color: #d8dee9">decoded</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">append</span><span style="color: #eceff4">(</span><span style="color: #a3be8c">&quot;&quot;</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">join</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">decode</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">encoded_response</span><span style="color: #eceff4">)))</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238"></a>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239"></a>                <span style="color: #81a1c1; font-weight: bold">if</span> <span style="color: #81a1c1">len</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">)</span> <span style="color: #81a1c1; font-weight: bold">==</span> <span style="color: #b48ead">1</span><span style="color: #eceff4">:</span>  <span style="color: #616e87; font-style: italic"># only one choice left</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240"></a>                    <span style="color: #d8dee9">choice_left</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1">self</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">tokenizer</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">decode</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">encoded_choices_left</span><span style="color: #eceff4">[</span><span style="color: #b48ead">0</span><span style="color: #eceff4">])</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241"></a>                    <span style="color: #d8dee9">decoded</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">append</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">choice_left</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242"></a>                    <span style="color: #81a1c1; font-weight: bold">break</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243"></a>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a>                <span style="color: #d8dee9">greedy</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #81a1c1; font-weight: bold">False</span>  <span style="color: #616e87; font-style: italic"># after each success, stay with (or switch to) &quot;optimistic&quot; approach</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span style="color: #d8dee9">prompt</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #d8dee9">prompt</span> <span style="color: #81a1c1; font-weight: bold">+</span> <span style="color: #a3be8c">&quot;&quot;</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">join</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">decoded</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span style="color: #d8dee9">choice</span> <span style="color: #81a1c1; font-weight: bold">=</span> <span style="color: #a3be8c">&quot;&quot;</span><span style="color: #81a1c1; font-weight: bold">.</span><span style="color: #d8dee9">join</span><span style="color: #eceff4">(</span><span style="color: #d8dee9">decoded</span><span style="color: #eceff4">)</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span style="color: #81a1c1; font-weight: bold">return</span> <span style="color: #d8dee9">choice</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="outlines.models.openai.OpenAI.generate_json" class="doc doc-heading">
            <code class="highlight language-python"><span style="color: #d8dee9">generate_json</span><span style="color: #eceff4">()</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Call the OpenAI API to generate a JSON object.</p>

            <details class="quote">
              <summary>Source code in <code>outlines/models/openai.py</code></summary>
              <div class="language-python highlight" style="background: #2E3440"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-252">252</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-253">253</a></span>
<span style="color: #D8DEE9; background-color: #242933; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-254">254</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a><span style="color: #81a1c1; font-weight: bold">def</span> <span style="color: #88c0d0">generate_json</span><span style="color: #eceff4">(</span><span style="color: #81a1c1">self</span><span style="color: #eceff4">):</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span style="color: #d8dee9">    </span><span style="color: #616e87">&quot;&quot;&quot;Call the OpenAI API to generate a JSON object.&quot;&quot;&quot;</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span style="color: #81a1c1; font-weight: bold">raise</span> <span style="color: #bf616a">NotImplementedError</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>







  
  



  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023- The Outlines Developers
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/outlines-dev" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/remilouf" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.expand", "navigation.tabs", "navigation.sections", "header.autohide", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>